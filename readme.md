# Платіжний модуль hutko для OpenCart

hutko — це сучасний платіжний сервіс, який допомагає бізнесу розвиватися на всіх етапах: запуску, масштабуванні та розширенні. Надійний. Швидкий. Зручний.

Цей модуль інтегрує платіжний шлюз hutko у ваш інтернет-магазин OpenCart, надаючи клієнтам безпечний та зручний спосіб оплати замовлень онлайн.

## Зміст
1. [Функції](#функції)
2. [Вимоги](#вимоги)
3. [Встановлення](#встановлення)
4. [Конфігурація](#конфігурація)
5. [Використання](#використання)
6. [Підтримка](#підтримка)

## Функції
* Інтеграція онлайн-платежів з платіжною платформою hutko для **OpenCart 3.x**.
* Підтримка збереження платіжних посилань — зручно для повторних спроб платежів.
* Повернення коштів (повне або часткове) безпосередньо зі сторінки перегляду замовлення OpenCart.
* Синхронізація статусів платежів.
* Автоматичне оновлення статусів замовлень в OpenCart.
* Можливість включення/виключення вартості доставки до загальної суми платежу.
* Журнал запитів до API hutko — для діагностики та підвищення безпеки.

## Вимоги
* **Версія OpenCart:** 3.0.0.0 або пізнішої версії
* **Версія PHP:** 7.3 або пізнішої версії.
* **Розширення PHP cURL:** Повинно бути ввімкнено на вашому сервері.

## Встановлення

**Перед встановленням переконайтеся, що розширення PHP cURL активне на вашому сервері.**

1. **Завантажте модуль:**
* Отримайте останню версію модуля з офіційного репозиторію модулів (шукайте на hutko.org).

2. **Встановлення в OpenCart:**
* Увійдіть до панелі адміністратора OpenCart.
* Перейдіть до **Розширення > Інсталятор**.
* Натисніть кнопку **Завантажити**.
* Виберіть завантажений файл модуля `.ocmod.zip` та завантажте його.
* Зачекайте завершення процесу завантаження та встановлення.
* Далі перейдіть до **Розширення > Зміни**.
* Натисніть синю кнопку **Оновити** (у верхньому правому куті), щоб застосувати будь-які зміни.
* Потім перейдіть до **Розширення > Розширення**.
* Виберіть **Платежі** з випадаючого фільтра «Виберіть тип розширення».
* Знайдіть "hutko".
* Натисніть зелену кнопку **Встановити** (значок `+`) поруч.

## Налаштування

Після встановлення вам потрібно налаштувати модуль за допомогою облікових даних вашого облікового запису hutko.

1. **Налаштування модуля доступу:**
* В адміністративній панелі OpenCart перейдіть до **Розширення > Розширення**.
* Виберіть **Платежі** з випадаючого фільтра "Виберіть тип розширення".
* Знайдіть hutko у списку та натисніть синю кнопку **Редагувати** (значок олівця).
* Через політику безпеки Cookie SameSite, при поверненні на сайт зі сторінки платежів hutko, клієнт буде деавторизований. Для уникнення незручностей клієнтів змініть метод перенаправлення з POST на GET на порталі Hutko (Налаштування -> Налаштування платежів -> Метод перенаправлення на сторінку результату)

2. **Введіть облікові дані облікового запису:**
* **Ідентифікатор продавця:** Ваш унікальний ідентифікатор, наданий hutko (обов'язкове поле).
* **Секретний ключ:** Секретний ключ, необхідний для захисту підписів транзакцій (обов'язкове поле).

3. **Статуси замовлень:**
* Виберіть відповідні статуси замовлень OpenCart, які модуль має встановити для:
* **Статус успішного платежу:** (наприклад, Обробка, Завершено)
* **Статус нового замовлення:** (наприклад, Очікування)
* **Статус невдалого платежу:** (наприклад, Не вдалося, Скасовано)
* **Статус платежу, термін дії якого минув:** (наприклад, Минув, Скасовано)

4. **Додаткові налаштування:**
* Встановити **Геозону**, для якої доступний цей спосіб оплати.
* Встановити **Загальну суму** – загальна сума замовлення має досягати цього значення, щоб спосіб оплати був доступним.
* Встановити **Порядок сортування**, щоб контролювати його позицію серед інших способів оплати.
* Увімкнути/вимкнути модуль можна за допомогою опції **Статус**.
* Для сумісності фіскалізації можливо вимкнути передачу фіксованих знижок до серверів hutko.

5. **Зберегти налаштування**:

* Натисніть кнопку **Зберегти** (угорі праворуч).

⚠️ **Модуль не працюватиме належним чином без дійсних облікових даних сервісу hutko.**

## Використання

Після налаштування модуль автоматично додасть hutko як варіант оплати на сторінці оформлення замовлення.

1. Клієнт вибирає «Сплатити через hutko».
2. Клієнта перенаправляє на захищену сторінку оплати hutko.
3. Після успішної оплати клієнт автоматично перенаправляється назад до вашого магазину OpenCart, і статус замовлення оновлюється відповідно.
4. У разі помилки оплати або відхилення клієнта буде перенаправлено назад з відповідним повідомленням про помилку, а статус замовлення відображатиме помилку.
5. Модуль автоматично отримує оновлення від сервера hutko щодо статусу оплати. Якщо статус зміниться на «відхилено» або «термін дії минув», модуль призначить відповідний налаштований статус замовлення в OpenCart (наприклад, «Невдалий платіж» або «Помилка платежу»).
6. Замовлення створюється до оплати. Таким чином ви не втрачаєте контакти клієнта та зможете швидше повернути його до процесу покупки.
7. У статусах платежів зберігається посилання на оплату, яке ви легко можете повторно направити клієнту.

